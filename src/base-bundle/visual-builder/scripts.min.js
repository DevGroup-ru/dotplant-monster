!function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}n(24);var a=n(4),i=r(a);window.FrontendMonster=new i["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),s=r(o),l=function(){function e(t,n){a(this,e),this.visualBuilder=t,this.name=n,this.target=$(this.visualBuilder.settings["frame-selector"])[0].contentWindow}return i(e,[{key:"activate",value:function(){this.name!==this.visualBuilder.currentEnvironment&&this.visualBuilder.currentEnvironment&&this.visualBuilder.environments.get(this.visualBuilder.currentEnvironment).deactivate()}},{key:"deactivate",value:function(){this.visualBuilder.clearStackable()}},{key:"sendMessage",value:function(e,t){return s["default"].sendMessage(this.target,e,t)}},{key:"pageChanged",value:function(){}}]),e}();t["default"]=l},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){n(this,e)}return r(e,null,[{key:"bindMessageListener",value:function(t){var n=function(n){var r=null;r=e.isIe?JSON.parse(n.data):n.data,t[r.func]&&t[r.func].apply(t,r.args)};window.addEventListener?window.addEventListener("message",n):window.attachEvent("onmessage",n)}},{key:"sendMessage",value:function(t,n,r){var a={func:n,args:r},i=e.isIe?JSON.stringify(a):a;t.postMessage(i,"*")}},{key:"isIe",get:function(){return"undefined"==typeof is||is.ie()}}]),e}();t["default"]=a},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(8),s=r(o),l=n(21),u=r(l),c=n(20),f=r(c),d=function(){function e(){a(this,e),this.params(),this.visualBulder=null,this.hashApi=new f["default"],window.parent!==window&&window.parent.FrontendMonster&&window.parent.FrontendMonster.hasBuilder&&(this.VisualFrame=new u["default"]),"undefined"!=typeof smoothScroll&&smoothScroll.init()}return i(e,[{key:"params",value:function(){var e=window.FrontendMonsterSettings||{},t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);this.settings=t}},{key:"builder",get:function(){return null===this.visualBulder&&(this.visualBulder=new s["default"]),this.visualBulder}},{key:"hasBuilder",get:function(){return 1===this.builder.$builder.length}}]),e}();t["default"]=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(10),s=r(o),l=function(){function e(){a(this,e),this.editablesByType={},(0,s["default"])(),this.editablesByType=window.MONSTER_EDITABLES}return i(e,[{key:"serializeEditable",value:function(e){var t=e.data("bem"),n=e.data("bemMatch");if(t=t.hasOwnProperty(n)?t[n]:{},t.hasOwnProperty("editable")===!1)return null;var r=t.editable,a=r.hasOwnProperty("type")?r.type:"string";this.editablesByType.hasOwnProperty(a)===!1&&(a="string");var i=r.hasOwnProperty("target")?r.target:"data";return this.editablesByType[a](e,i)}}]),e}();t["default"]=l},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){n(this,e),this.$node=t,this.materialPath=this.$node.data("materialPath"),this.name=this.materialPath.replace(/.*\.(.*)$/,"$1"),
//!@todo CHANGE THIS
this.key=this.$node.data("materialIndex")}return a(e,[{key:"processMaterial",value:function(){var e=$('<li class="page-structure__material">'+this.name+"</li>");return e}},{key:"serialize",value:function(){var t=this.$node.data("editableKeys"),n=function(t,a,i){var o={},s=!0,l=!1,u=void 0;try{for(var c,f=function(){var s=c.value,l=s;if(a&&(l=a+"."+s),"object"===r(t[s])){var u=i.find('[data-recursive-item="'+l+'"]');o[s]={},u.each(function(){var e=$(this);o[s][e.data("recursiveItemKey")]=n(t[s],"item",e)})}else{var f=i.find('[data-editable-key="'+l+'"]');o[s]=e.serializeNode(f)}},d=Object.keys(t)[Symbol.iterator]();!(s=(c=d.next()).done);s=!0)f()}catch(h){l=!0,u=h}finally{try{!s&&d["return"]&&d["return"]()}finally{if(l)throw u}}return o},a=n(t,"",this.$node);return console.log(a),a}}],[{key:"serializeNode",value:function(e){return window.FrontendMonster.builder.editable.serializeEditable(e)}}]),e}();t["default"]=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(6),s=r(o),l=function(){function e(t){a(this,e),this.materials={},this.$node=t,this.description=t.data("contentDescription")}return i(e,[{key:"processRegion",value:function(){var e=$('<li class="page-structure__region">'+this.regionDescription+"</li>");this.key=this.$node.data("regionKey"),this.id=this.$node.data("regionId");var t=$('<ul class="page-structure__region-materials"></ul>'),n=this.$node.find("[data-is-material=1]"),r=this;return n.each(function(){var e=$(this),n=new s["default"](e),a=n.processMaterial();r.materials[n.key]=n,t.append(a)}),e.append(t),e}},{key:"serialize",value:function(){var e={},t=this.materials;return Object.keys(t).forEach(function(n){e[n]=t[n].serialize()}),e}},{key:"materialsDecl",value:function(){var e={};for(var t in this.materials)this.materials.hasOwnProperty(t)&&(e[t]={material:this.materials[t].materialPath});return e}}]),e}();t["default"]=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(18),s=r(o),l=n(16),u=r(l),c=n(15),f=r(c),d=n(14),h=r(d),p=n(17),v=r(p),y=n(2),m=r(y),b=n(5),g=r(b),w=function(){function e(){a(this,e),this.params(),this.resolutionSwitcher(),this.environments=new Map([["site-structure",new s["default"](this,"site-structure")],["page-structure",new v["default"](this,"page-structure")],["materials",new u["default"](this,"materials")],["customization",new f["default"](this,"customization")],["action",new h["default"](this,"action")]]),this.environmentSelector(),this.switchEnvironment("site-structure"),$(".monster-environment-selector__environment-link").first().addClass("monster-environment-selector__environment-link--active"),m["default"].bindMessageListener(this),this.editable=new g["default"],this.controls()}return i(e,[{key:"params",value:function(){var e=window.VisualBuilderSettings||{},t={"element-selector":".monster-visual-builder","frame-selector":".monster-visual-frame",bundles:{},"stackable-container-class":"monster-stackable-container","new-block-url":"/monster/visual-builder/new-block"};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);this.settings=t,this.$builder=$(this.settings["element-selector"]),this.$stackable=$("."+this.settings["stackable-container-class"])}},{key:"resolutionSwitcher",value:function(){var e=this,t="resolution-switcher__resolution-link",n=t+"--active",r=$("."+t);r.click(function(){return r.removeClass(n),$(e.settings["frame-selector"]).width($(this).data("resolutionWidth")),$(this).addClass(n),!1})}},{key:"environmentSelector",value:function(){var e=this,t="monster-environment-selector__environment-link",n=t+"--active",r=$("."+t);r.click(function(){var t=$(this).data("environmentName");return e.currentEnvironment===t?(r.removeClass(n),e.environments.get(t).deactivate(),e.currentEnvironment=null,!1):(r.removeClass(n),e.switchEnvironment(t),$(this).addClass(n),!1)})}},{key:"switchEnvironment",value:function(e){this.environments.get(e).activate(),this.currentEnvironment=e}},{key:"clearStackable",value:function(){this.$stackable.empty()}},{key:"createStackablePane",value:function(){var e=this.settings["stackable-container-class"]+"__pane",t=0===this.$stackable.find("."+e).length?e+"--first":"",n=$('<div class="'+e+" "+t+'"></div>');return this.$stackable.append(n),n}},{key:"materialByName",value:function(e){return this.settings.materials.hasOwnProperty(e)?this.settings.materials[e]:null}},{key:"serialize",value:function(){var e=this.environments.get("page-structure").serializePage();console.log(e);var t={},n=this.frameContentWindow.MONSTER_EDIT_MODE_DATA.template.providedKeys;for(var r in n)if(n.hasOwnProperty(r)!==!1){t[r]={};var a=n[r];for(var i in a)if(a.hasOwnProperty(i)!==!1&&e.hasOwnProperty(i)!==!1){t[r][i]={};var o=a[i];for(var s in o)if(o.hasOwnProperty(s)!==!1&&e[i].hasOwnProperty(s)!==!1){t[r][i][s]={};var l=o[s],u=!0,c=!1,f=void 0;try{for(var d,h=l[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var p=d.value;e[i][s].hasOwnProperty(p)!==!1&&(t[r][i][s][p]=e[i][s][p])}}catch(v){c=!0,f=v}finally{try{!u&&h["return"]&&h["return"]()}finally{if(c)throw f}}}}}return t}},{key:"pageChanged",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.environments[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var i=r.value;i[1].pageChanged()}}catch(o){t=!0,n=o}finally{try{!e&&a["return"]&&a["return"]()}finally{if(t)throw n}}}},{key:"log",value:function(e){console.log(e)}},{key:"controls",value:function(){this.$controls=this.$builder.find(".controls");var e=this;this.$controls.find(".controls__refresh").click(function(){return e.frameContentWindow.location.reload(),!1}),this.$controls.find(".controls__save").click(function(){return $.ajax({url:e.frameContentWindow.location,method:"POST",cache:!1,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({template:{providersEntities:e.serialize(),regionsMaterials:e.environments.get("page-structure").materialsByRegions()},action:"save"}),success:function(e,t,n){console.log(e)},error:function(e,t,n){console.log(e)}}),!1})}},{key:"frameContentWindow",get:function(){return $(this.settings["frame-selector"])[0].contentWindow}}]),e}();t["default"]=w},function(e,t){"use strict";function n(e){return e.html()}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(){"undefined"==typeof window.MONSTER_EDITABLES&&(window.MONSTER_EDITABLES={}),window.MONSTER_EDITABLES.wysiwyg=o["default"],window.MONSTER_EDITABLES.link=c["default"],window.MONSTER_EDITABLES.image=l["default"],window.MONSTER_EDITABLES.string=d["default"]}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=a;var i=n(9),o=r(i),s=n(11),l=r(s),u=n(12),c=r(u),f=n(13),d=r(f)},function(e,t){"use strict";function n(e){var t=e.find("img").first();return{src:t.attr("src"),alt:t.attr("alt")}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t){"use strict";function n(e){return{src:e.attr("href"),anchor:e.html()}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){return e.text()}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=r(s),u=function(e){function t(){return a(this,t),i(this,Object.getPrototypeOf(t).apply(this,arguments))}return o(t,e),t}(l["default"]);t["default"]=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=r(s),u=function(e){function t(){return a(this,t),i(this,Object.getPrototypeOf(t).apply(this,arguments))}return o(t,e),t}(l["default"]);t["default"]=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function d(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:d(a,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},u=n(1),c=r(u),f=function(e){function t(e,n){a(this,t);var r=i(this,Object.getPrototypeOf(t).call(this,e,n));return r.initMaterialsSelector(),r}return o(t,e),s(t,[{key:"initMaterialsSelector",value:function(){this.$materialsGroups=$('<ul class="materials-groups"></ul>'),this.$materialsList=[];var e=!0,t=!1,n=void 0;try{for(var r,a=this.visualBuilder.settings.bundles[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var i=r.value,o="undefined"!=typeof polyglot?polyglot.t(i.name):i.name,s='\n      <li class="materials-groups__item materials-groups__item--bundle-label">\n        <a href="#" class="materials-groups__switch-bundle" data-bundle-path=""'+i.fullPath+">\n            "+o+"\n        </a>\n      </li>\n      ";this.$materialsList.push(s);var l=!0,u=!1,c=void 0;try{for(var f,d=i.groups[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var h=f.value,p=h.name,v=h.materials,y="undefined"!=typeof polyglot?polyglot.t(p):p,m=$('\n    <li class="materials-groups__item">\n      <a href="#" data-group-path="'+h.fullPath+'" class="materials-groups__switch-group">\n        '+y+' <span class="materials-groups__count">('+v.length+")</span>\n      </a>\n    </li>");this.$materialsGroups.append(m);var b=$('<ul class="materials-list" data-group-path="'+h.fullPath+'"></ul>'),g=[],w=!0,_=!1,k=void 0;try{for(var O,M=v[Symbol.iterator]();!(w=(O=M.next()).done);w=!0){var P=O.value,C=P.name,S="undefined"!=typeof polyglot?polyglot.t(C):C,j=$('\n<li>\n  <a href="#" class="materials-list__item" data-material-path="'+P.fullPath+'">'+S+"</a>\n</li>\n");g.push(j)}}catch(E){_=!0,k=E}finally{try{!w&&M["return"]&&M["return"]()}finally{if(_)throw k}}b.append(g),this.$materialsList.push(b)}}catch(E){u=!0,c=E}finally{try{!l&&d["return"]&&d["return"]()}finally{if(u)throw c}}}}catch(E){t=!0,n=E}finally{try{!e&&a["return"]&&a["return"]()}finally{if(t)throw n}}var T=this;$(document).on("click",".materials-groups__switch-group",function(){var e=$(this),t="materials-groups__switch-group--active";e.toggleClass(t);var n=e.data("groupPath");return e.hasClass(t)?!function(){$(".materials-groups__switch-group").removeClass(t);var r="materials-list--active";$(".materials-list").each(function(){var e=$(this);e.hasClass(r)&&e.removeClass(r),e.data("groupPath")===n&&e.addClass(r)}),e.addClass(t),T.$materialsPane.show()}():T.$materialsPane.hide(),!1}),$(document).on("click",".materials-list__item",function(){T.sendMessage("newBlock",[$(this).data("materialPath"),"content"])})}},{key:"activate",value:function(){l(Object.getPrototypeOf(t.prototype),"activate",this).call(this),this.$groupsPane=this.visualBuilder.createStackablePane(),this.$groupsPane.append(this.$materialsGroups),this.$materialsPane=this.visualBuilder.createStackablePane(),this.$materialsPane.append(this.$materialsList),this.$materialsPane.hide(),$(".materials-groups__switch-group").removeClass("materials-groups__switch-group--active")}}]),t}(c["default"]);t["default"]=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function p(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:p(a,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},u=n(1),c=r(u),f=n(7),d=r(f),h=function(e){function t(e,n){a(this,t);var r=i(this,Object.getPrototypeOf(t).call(this,e,n));return r.initPageStructureElement(),r.editModeData={},r}return o(t,e),s(t,[{key:"initPageStructureElement",value:function(){this.$pageStructure=$('<ul class="page-structure"></ul>')}},{key:"activate",value:function(){l(Object.getPrototypeOf(t.prototype),"activate",this).call(this),this.$structurePane=this.visualBuilder.createStackablePane(),this.$structurePane.append(this.$pageStructure)}},{key:"pageChanged",value:function(){l(Object.getPrototypeOf(t.prototype),"pageChanged",this).call(this),this.$pageStructure.find("li").remove();var e=this.target.$(".m-monster-content__content"),n=this;this.regionsStructure={};var r=this;e.each(function(){var e=$(this),t=new d["default"](e),a=t.processRegion();r.regionsStructure[t.key]=t,n.$pageStructure.append(a)}),this.editModeData=this.target.MONSTER_EDIT_MODE_DATA}},{key:"serializePage",value:function(){var e={};for(var t in this.regionsStructure)if(this.regionsStructure.hasOwnProperty(t)){var n=this.regionsStructure[t];e[n.key]=n.serialize()}return e}},{key:"materialsByRegions",value:function(){var e={};for(var t in this.regionsStructure)if(this.regionsStructure.hasOwnProperty(t)){var n=this.regionsStructure[t];e[n.key]=n.materialsDecl()}return e}}]),t}(c["default"]);t["default"]=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=r(s),u=function(e){function t(){return a(this,t),i(this,Object.getPrototypeOf(t).apply(this,arguments))}return o(t,e),t}(l["default"]);t["default"]=u},function(e,t){"use strict";e.exports=function(e,t){"undefined"==typeof e&&(e="");var n,r=function(e,t){return e=parseInt(e,10).toString(16),t<e.length?e.slice(e.length-t):t>e.length?Array(1+(t-e.length)).join("0")+e:e},a="undefined"!=typeof window?window:GLOBAL;a.$locutus=a.$locutus||{};var i=a.$locutus;return i.php=i.php||{},i.php.uniqidSeed||(i.php.uniqidSeed=Math.floor(123456789*Math.random())),i.php.uniqidSeed++,n=e,n+=r(parseInt((new Date).getTime()/1e3,10),8),n+=r(i.php.uniqidSeed,5),t&&(n+=(10*Math.random()).toFixed(8).toString()),n}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){if(n(this,e),this.functionCalls={},document.location.hash){var t=document.location.hash.match(/#hashApi:(.*?):\/hashApi/);if(t&&2===t.length){var r=JSON.parse(decodeURIComponent(t[1])),a=!0,i=!1,o=void 0;try{for(var s,l=r[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var u=s.value;u.func&&(this.functionCalls[u.func]=u.args||{})}}catch(c){i=!0,o=c}finally{try{!a&&l["return"]&&l["return"]()}finally{if(i)throw o}}}}}return r(e,[{key:"shouldCall",value:function(e){return this.functionCalls[e]||!1}}]),e}();t["default"]=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),s=r(o),l=n(19),u=r(l),c=function(){function e(){a(this,e),this.params(),this.initialize()}return i(e,[{key:"initialize",value:function(){s["default"].bindMessageListener(this),this.parentWindow=window.parent,this.parentMonster=this.parentWindow.FrontendMonster,this.parentBuilder=this.parentMonster.builder,this.currentMonsterContent=!1,this.makeItMove();var e=this;$(window).resize(function(){return e.updateHandlers(),!0}),this.parentBuilder.pageChanged()}},{key:"refreshMonsterContentCache",value:function(){this.$monsterContentCache={};var e=this;$(this.settings["monster-content-selector"]).each(function(){e.currentMonsterContent||(e.currentMonsterContent=$(this).data("uniqueContentId")),e.$monsterContentCache[$(this).data("uniqueContentId")]=$(this)})}},{key:"getNewMaterialIndex",value:function(){if(!this.lastMaterialIndex){var e=0;$("[data-is-material]").each(function(){var t=$(this).data("material-index");t>e&&(e=t)}),this.lastMaterialIndex=e}return this.lastMaterialIndex++,this.lastMaterialIndex}},{key:"updateHandlers",value:function(){this.$selectedMaterial&&this.$handlers&&(this.$handlers.css("top",this.$selectedMaterial.position().top+this.$selectedMaterial.height()-this.$handlers.height()),this.$selectedMaterial.addClass("m-monster-content__material--active"))}},{key:"makeItMove",value:function(){this.$handlers=$('\n<div class="monster-block-handlers">\n    <a href="#" class="monster-block-handlers__configure">\n        <i class="fa fa-cog"></i>\n    </a>\n    <span class="monster-block-handlers__block-name">Block name here</span>\n    <a href="#" class="monster-block-handlers__move-up">\n        <i class="fa fa-angle-up"></i>\n    </a>\n    <a href="#" class="monster-block-handlers__move-down">\n        <i class="fa fa-angle-down"></i>\n    </a>\n    <a href="#" class="monster-block-handlers__clone">\n        <i class="fa fa-clone"></i>\n    </a>\n    <a href="#" class="monster-block-handlers__remove">\n        <i class="fa fa-times"></i>\n    </a>\n</div>'),$("body").append(this.$handlers),this.$handlers.hide();var e=this;$(this.settings["monster-content-selector"]).on({mouseenter:function(){var e=$(this);e.addClass("m-monster-content__material--highlighted")},mouseleave:function(){var e=$(this);e.removeClass("m-monster-content__material--highlighted")},click:function(){var t=$(this);e.selectMaterial(t)}},"[data-is-material]"),e.$handlers.on("click",".monster-block-handlers__move-up",function(){if(e.$selectedMaterial){var t=e.$selectedMaterial.prev("[data-is-material]");1==t.length&&(e.$selectedMaterial.insertBefore(t),e.updateHandlers())}return!1}).on("click",".monster-block-handlers__move-down",function(){if(e.$selectedMaterial){var t=e.$selectedMaterial.next("[data-is-material]");1==t.length&&(e.$selectedMaterial.insertAfter(t),e.updateHandlers())}return!1}).on("click",".monster-block-handlers__clone",function(){if(e.$selectedMaterial){var t=e.$selectedMaterial.clone();t.data("material-index",e.getNewMaterialIndex()).insertAfter(e.$selectedMaterial),e.selectMaterial(t)}return!1}).on("click",".monster-block-handlers__remove",function(){return e.$selectedMaterial&&confirm("Are you sure you want to remove this material?")&&(e.$selectedMaterial.remove(),e.$selectedMaterial=null,e.$handlers.hide()),!1})}},{key:"selectMaterial",value:function(e){this.$selectedMaterial!==e&&(this.$selectedMaterial&&this.$selectedMaterial.removeClass("m-monster-content__material--active"),this.$selectedMaterial=e,this.updateHandlers(),this.$handlers.show())}},{key:"serializeContent",value:function(e){var t={},n=this;for(var r in this.$monsterContent)if(this.$monsterContent.hasOwnProperty(r)){var a=this.$monsterContent[r];t[a.data("uniqueContentId")]=n.serializeUniqueContent(a)}this.sendToBuilder(e,[t])}},{key:"serializeUniqueContent",value:function(e){var t={};return t.uniqueContentId=e.data("uniqueContentId"),t.materials={},e.find("[data-is-material='1']").each(function(){var e={};e.block=$(this).data("materialBlock"),t.materials[$(this).data("materialIndex")]=e}),t}},{key:"params",value:function(){var e=window.VisualFrameSettings||{},t={"monster-content-selector":".m-monster-content__content"};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);this.settings=t}},{key:"sendToBuilder",value:function(e,t){s["default"].sendMessage(this.parentWindow,e,t)}},{key:"newBlock",value:function(e,t){var n=(0,u["default"])("mat"),r={template:{providersEntities:this.parentBuilder.serialize(),regionsMaterials:this.parentBuilder.environments.get("page-structure").materialsByRegions()},action:"render-material",materialId:n,materialRegion:t,material:e};r.template.regionsMaterials.hasOwnProperty(t)===!1&&(r.template.regionsMaterials[t]={}),r.template.regionsMaterials[t][n]={material:e};var a=$('<form method="POST"></form>'),i=$('<input type="hidden" name="__json">'),o=$('<input type="hidden">');return o.attr("name",$("meta[name=csrf-param]").attr("content")).val($("meta[name=csrf-token]").attr("content")).appendTo(a),i.val(JSON.stringify(r)).appendTo(a),a[0].submit(),!1}},{key:"$monsterContent",get:function(){return this.$monsterContentCache?this.$monsterContentCache:(this.refreshMonsterContentCache(),this.$monsterContentCache)}}]),e}();t["default"]=c},,,function(e,t){}]);